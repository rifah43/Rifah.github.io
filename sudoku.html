<html lang="en">

<head>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0;
        }

        h2 {
            color: aliceblue;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        }

        table {
            background-color: bisque;
            border-collapse: collapse;
            margin: 20px auto;
            width: 180px; /* Set a maximum width */
            height: 180px;
        }

        td {
            width: 20px;
            height: 20px;
            text-align: center;
            border: 1px solid #ccc;
            background-color: rgb(188, 252, 221);
            color: black;
            font-size: 3vw; /* Adjust font size using relative units */
        }

        input {
            background-color: rgb(255, 255, 255);
            width: 20px;
            height: 20px;
            text-align: center;
        }

        .pre-determined {
            background-color: rgb(188, 252, 221);
            color: black;
        }

        button {
            background-color: rgb(188, 252, 221);
            color: rgb(0, 0, 0);
            border: rgb(255, 255, 255) solid 2px;
            height: 50px;
            width: 110px;
            border-radius: 5px;
            font-size: smaller;
            margin: 3px; /* Add some margin */
        }

        /* Media query for smaller screens */
        @media only screen and (max-width: 600px) {
            td,
            input,
            button {
                font-size: 5vw; /* Adjust font size for smaller screens */
            }
        }
    </style>
</head>

<body onload="generateBoard()">
    <h2>Solve if you love sudoku!</h2>
    <table id="sudoku-board"></table>
    <div>
        <button onclick="generateBoard()">Reset Game</button>
        <button onclick="checkSolution()">Check Solution</button>
    </div>

    <script>
        function generateBoard() {
            document.getElementById("sudoku-board").innerHTML = "";

            let board = generateSudoku();

            let table = document.getElementById("sudoku-board");
            for (let i = 0; i < 9; i++) {
                let row = table.insertRow(i);
                for (let j = 0; j < 9; j++) {
                    let cell = row.insertCell(j);
                    let input = document.createElement("input");
                    input.type = "text";
                    input.maxLength = 1;
                    input.size = 1;
                    input.addEventListener("input", function () {
                        validateInput(this);
                    });
                    cell.appendChild(input);

                    if (board[i][j] !== 0) {
                        input.value = "";
                        input.placeholder = board[i][j];
                        input.disabled = false;
                        input.classList.add("pre-determined");
                    }
                }
            }
        }

        function validateInput(input) {
            input.value = input.value.replace(/[^1-9]/g, '');

            if (input.value.length > 1) {
                input.value = input.value.slice(0, 1);
            }
        }

        function checkSolution() {
            let table = document.getElementById("sudoku-board");
            let solutionCorrect = true;

            for (let i = 0; i < 9; i++) {
                let rowValues = new Set();
                let colValues = new Set();

                for (let j = 0; j < 9; j++) {
                    let rowInput = table.rows[i].cells[j].querySelector("input").value;
                    let colInput = table.rows[j].cells[i].querySelector("input").value;

                    if ((rowValues.has(rowInput) && rowInput !== "") || (colValues.has(colInput) && colInput !== "")) {
                        solutionCorrect = false;
                        break;
                    }

                    rowValues.add(rowInput);
                    colValues.add(colInput);
                }

                if (!solutionCorrect) {
                    break;
                }
            }

            if (solutionCorrect) {
                alert("Congratulations! You've solved the Sudoku puzzle.");
            } else {
                alert("Sorry, the solution is not correct. Keep trying!");
            }
        }
        
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function generateSudoku() {
            // Create a solved Sudoku board
            let base = [
                [1, 2, 3, 4, 5, 6, 7, 8, 9],
                [4, 5, 6, 7, 8, 9, 1, 2, 3],
                [7, 8, 9, 1, 2, 3, 4, 5, 6],
                [2, 3, 4, 5, 6, 7, 8, 9, 1],
                [5, 6, 7, 8, 9, 1, 2, 3, 4],
                [8, 9, 1, 2, 3, 4, 5, 6, 7],
                [3, 4, 5, 6, 7, 8, 9, 1, 2],
                [6, 7, 8, 9, 1, 2, 3, 4, 5],
                [9, 1, 2, 3, 4, 5, 6, 7, 8]
            ];

            // Shuffle 3 sets of rows
            for (let i = 0; i < 9; i += 3) {
                shuffleArray(base.slice(i, i + 3));
            }

            // Transpose the board to shuffle columns within each 3x3 grid
            // base = base[0].map((col, i) => base.map(row => row[i]));

            // Shuffle columns within each 3x3 grid
            // for (let i = 0; i < 3; i++) {
            //     for (let j = 0; j < 9; j += 3) {
            //         const randomIndex1 = j + Math.floor(Math.random() * 3);
            //         const randomIndex2 = j + Math.floor(Math.random() * 3);
            //         [base[i][randomIndex1], base[i][randomIndex2]] = [base[i][randomIndex2], base[i][randomIndex1]];
            //     }
            // }

            // Create the puzzle by removing some numbers
            let puzzle = [];
            for (let i = 0; i < 9; i++) {
                puzzle[i] = base[i].slice(0, 9);
            }

            // Remove some numbers from the puzzle
            for (let i = 0; i < 60; i++) {
                let row = Math.floor(Math.random() * 9);
                let col = Math.floor(Math.random() * 9);
                puzzle[row][col] = 0;
            }

            return puzzle;
        }
    </script>

</body>

</html>